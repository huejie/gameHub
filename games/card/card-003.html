<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é’“é±¼æ¥é¾™ - GameHub</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a472a 0%, #2d5016 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }
        .header {
            text-align: center;
            margin-bottom: 20px;
        }
        .header h1 {
            color: #ffd700;
            font-size: 2rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
        .back-link {
            display: inline-block;
            margin-top: 10px;
            color: #fff;
            text-decoration: none;
            background: rgba(255,255,255,0.2);
            padding: 8px 16px;
            border-radius: 20px;
            transition: all 0.3s;
        }
        .back-link:hover {
            background: rgba(255,255,255,0.3);
        }
        .game-container {
            background: rgba(0,0,0,0.3);
            border-radius: 20px;
            padding: 20px;
            width: 100%;
            max-width: 800px;
        }
        .score-board {
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }
        .score-item {
            background: rgba(255,255,255,0.1);
            padding: 15px 25px;
            border-radius: 10px;
            color: #fff;
            text-align: center;
        }
        .score-item .label {
            font-size: 0.9rem;
            opacity: 0.8;
        }
        .score-item .value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #ffd700;
        }
        .table-area {
            background: rgba(0,0,0,0.2);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            min-height: 150px;
        }
        .table-label {
            color: #fff;
            margin-bottom: 10px;
            font-size: 0.9rem;
        }
        .cards-row {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            min-height: 100px;
            align-items: center;
        }
        .card {
            width: 60px;
            height: 85px;
            background: linear-gradient(145deg, #fff, #f0f0f0);
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            position: relative;
            transition: all 0.3s;
        }
        .card.red {
            color: #d32f2f;
        }
        .card.black {
            color: #212121;
        }
        .card .suit {
            font-size: 22px;
        }
        .card .rank {
            font-size: 14px;
            margin-top: -3px;
        }
        .card.back {
            background: linear-gradient(145deg, #1565c0, #0d47a1);
        }
        .card.back::before {
            content: 'ğŸ´';
            font-size: 28px;
        }
        .card.table-card {
            cursor: pointer;
        }
        .card.table-card:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 15px rgba(255,215,0,0.4);
        }
        .card.highlight {
            animation: pulse 0.5s ease-in-out infinite alternate;
        }
        @keyframes pulse {
            from { box-shadow: 0 4px 8px rgba(0,0,0,0.3); }
            to { box-shadow: 0 4px 20px rgba(255,215,0,0.6); }
        }
        .player-area {
            margin-top: 20px;
        }
        .player-hand {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            justify-content: center;
            margin-top: 10px;
        }
        .player-hand .card {
            cursor: pointer;
        }
        .player-hand .card:hover {
            transform: translateY(-10px);
        }
        .player-hand .card.selected {
            transform: translateY(-15px);
            box-shadow: 0 8px 20px rgba(255,215,0,0.5);
            border: 2px solid #ffd700;
        }
        .message {
            color: #ffd700;
            font-size: 1.2rem;
            text-align: center;
            min-height: 30px;
            margin: 15px 0;
        }
        .controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 15px;
        }
        .btn {
            padding: 12px 24px;
            font-size: 1rem;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }
        .btn-primary {
            background: linear-gradient(145deg, #ffd700, #ffaa00);
            color: #1a472a;
        }
        .btn-primary:hover {
            transform: scale(1.05);
        }
        .btn-secondary {
            background: rgba(255,255,255,0.2);
            color: #fff;
        }
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        .rules {
            background: rgba(0,0,0,0.3);
            color: #fff;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            font-size: 0.9rem;
        }
        .rules h3 {
            color: #ffd700;
            margin-bottom: 10px;
        }
        .rules ul {
            padding-left: 20px;
        }
        .rules li {
            margin: 5px 0;
        }
        .collected {
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
            justify-content: center;
            max-height: 100px;
            overflow-y: auto;
        }
        .collected .card {
            width: 40px;
            height: 56px;
            font-size: 0.8rem;
        }
        .collected .card .suit {
            font-size: 14px;
        }
        .collected .card .rank {
            font-size: 10px;
        }
        @media (max-width: 600px) {
            .card {
                width: 50px;
                height: 70px;
            }
            .card .suit {
                font-size: 18px;
            }
            .card .rank {
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸŸ é’“é±¼æ¥é¾™ ğŸŸ</h1>
        <a href="../../index.html" class="back-link">â† è¿”å›æ¸¸æˆåˆ—è¡¨</a>
    </div>
    
    <div class="game-container">
        <div class="score-board">
            <div class="score-item">
                <div class="label">ä½ çš„å¾—åˆ†</div>
                <div class="value" id="player-score">0</div>
            </div>
            <div class="score-item">
                <div class="label">ç”µè„‘å¾—åˆ†</div>
                <div class="value" id="computer-score">0</div>
            </div>
            <div class="score-item">
                <div class="label">å‰©ä½™ç‰Œ</div>
                <div class="value" id="remaining">52</div>
            </div>
        </div>
        
        <div class="message" id="message">ç‚¹å‡»"å¼€å§‹æ¸¸æˆ"</div>
        
        <div class="table-area">
            <div class="table-label">æ¡Œé¢ä¸Šçš„ç‰Œï¼ˆç‚¹å‡»åŒ¹é…ï¼‰</div>
            <div class="cards-row" id="table-cards"></div>
        </div>
        
        <div class="player-area">
            <div class="table-label">ä½ çš„æ‰‹ç‰Œï¼ˆé€‰æ‹©ä¸€å¼ ï¼‰</div>
            <div class="player-hand" id="player-hand"></div>
        </div>
        
        <div class="controls">
            <button class="btn btn-primary" id="start-btn" onclick="startGame()">å¼€å§‹æ¸¸æˆ</button>
            <button class="btn btn-primary" id="play-btn" onclick="playTurn()" style="display:none;">å‡ºç‰Œ</button>
            <button class="btn btn-secondary" onclick="showRules()">æ¸¸æˆè§„åˆ™</button>
        </div>
        
        <div class="rules" id="rules" style="display:none;">
            <h3>æ¸¸æˆè§„åˆ™</h3>
            <ul>
                <li>52å¼ ç‰Œå¹³åˆ†ï¼Œæ¯äºº26å¼ </li>
                <li>è½®æµå‡ºç‰Œåˆ°æ¡Œé¢</li>
                <li>å¦‚æœå‡ºçš„ç‰Œä¸æ¡Œä¸ŠæŸå¼ ç‰Œç‚¹æ•°ç›¸åŒï¼Œå¯ä»¥"é’“"èµ°å®ƒä»¬ä¹‹é—´çš„æ‰€æœ‰ç‰Œ</li>
                <li>ä¾‹å¦‚ï¼šæ¡Œä¸Šæœ‰ 3-7-5ï¼Œä½ å‡º5ï¼Œå¯ä»¥æ”¶èµ° 7-5-5</li>
                <li>Jæ˜¯ä¸‡èƒ½ç‰Œï¼Œå¯ä»¥åŒ¹é…ä»»ä½•ç‰Œ</li>
                <li>æ”¶åˆ°çš„ç‰Œè®¡å…¥å¾—åˆ†</li>
                <li>æ‰‹ç‰Œç”¨å®Œæ—¶æ¸¸æˆç»“æŸï¼Œå¾—åˆ†é«˜è€…è·èƒœ</li>
            </ul>
        </div>
    </div>

    <script>
        const SUITS = ['â™ ', 'â™¥', 'â™¦', 'â™£'];
        const RANKS = ['A', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K'];
        
        let playerHand = [];
        let computerHand = [];
        let tableCards = [];
        let playerScore = 0;
        let computerScore = 0;
        let selectedCard = -1;
        let gameActive = false;
        let isPlayerTurn = true;
        
        function createDeck() {
            const deck = [];
            for (let suit of SUITS) {
                for (let rank of RANKS) {
                    deck.push({ suit, rank });
                }
            }
            return deck;
        }
        
        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }
        
        function getCardColor(suit) {
            return suit === 'â™¥' || suit === 'â™¦' ? 'red' : 'black';
        }
        
        function createCardElement(card, isBack = false, extraClass = '') {
            if (isBack) {
                return `<div class="card back ${extraClass}"></div>`;
            }
            return `<div class="card ${getCardColor(card.suit)} ${extraClass}" data-rank="${card.rank}">
                <span class="suit">${card.suit}</span>
                <span class="rank">${card.rank}</span>
            </div>`;
        }
        
        function renderTable() {
            const container = document.getElementById('table-cards');
            if (tableCards.length === 0) {
                container.innerHTML = '<span style="color: rgba(255,255,255,0.5);">æ¡Œé¢ä¸Šæ²¡æœ‰ç‰Œ</span>';
            } else {
                container.innerHTML = tableCards.map((card, index) => 
                    createCardElement(card, false, 'table-card')
                ).join('');
            }
        }
        
        function renderPlayerHand() {
            const container = document.getElementById('player-hand');
            container.innerHTML = playerHand.map((card, index) => 
                createCardElement(card, false, index === selectedCard ? 'selected' : '')
            ).join('');
            
            // æ·»åŠ ç‚¹å‡»äº‹ä»¶
            container.querySelectorAll('.card').forEach((el, index) => {
                el.onclick = () => selectCard(index);
            });
        }
        
        function selectCard(index) {
            if (!gameActive || !isPlayerTurn) return;
            selectedCard = index;
            renderPlayerHand();
            document.getElementById('play-btn').style.display = 'inline-block';
        }
        
        function findMatch(card, table) {
            // Jå¯ä»¥åŒ¹é…ä»»ä½•ç‰Œ
            if (card.rank === 'J') {
                return table.length > 0 ? 0 : -1;
            }
            
            // æŸ¥æ‰¾åŒ¹é…çš„ç‰Œ
            for (let i = 0; i < table.length; i++) {
                if (table[i].rank === card.rank) {
                    return i;
                }
            }
            return -1;
        }
        
        function playTurn() {
            if (selectedCard === -1) return;
            
            const card = playerHand.splice(selectedCard, 1)[0];
            const matchIndex = findMatch(card, tableCards);
            
            if (matchIndex !== -1) {
                // åŒ¹é…æˆåŠŸï¼Œæ”¶ç‰Œ
                const collected = tableCards.splice(matchIndex);
                collected.push(card);
                playerScore += collected.length;
                
                updateMessage(`å¤ªæ£’äº†ï¼é’“åˆ°äº† ${collected.length} å¼ ç‰Œï¼`);
                updateScores();
            } else {
                // æ²¡æœ‰åŒ¹é…ï¼Œæ”¾åˆ°æ¡Œé¢
                tableCards.push(card);
                updateMessage('æ²¡æœ‰åŒ¹é…ï¼Œç‰Œæ”¾åˆ°æ¡Œé¢');
            }
            
            selectedCard = -1;
            document.getElementById('play-btn').style.display = 'none';
            
            renderTable();
            renderPlayerHand();
            
            // æ£€æŸ¥æ¸¸æˆæ˜¯å¦ç»“æŸ
            if (playerHand.length === 0 && computerHand.length === 0) {
                setTimeout(endGame, 1000);
                return;
            }
            
            if (playerHand.length === 0) {
                updateMessage('ä½ æ²¡æœ‰æ‰‹ç‰Œäº†ï¼Œç­‰å¾…ç”µè„‘...');
                setTimeout(computerTurn, 1000);
                return;
            }
            
            // ç”µè„‘å›åˆ
            isPlayerTurn = false;
            setTimeout(computerTurn, 1000);
        }
        
        function computerTurn() {
            if (computerHand.length === 0) {
                if (playerHand.length > 0) {
                    isPlayerTurn = true;
                    updateMessage('è½®åˆ°ä½ äº†');
                } else {
                    endGame();
                }
                return;
            }
            
            // ç®€å•AIï¼šéšæœºé€‰ä¸€å¼ ç‰Œ
            const randomIndex = Math.floor(Math.random() * computerHand.length);
            const card = computerHand.splice(randomIndex, 1)[0];
            
            updateMessage(`ç”µè„‘å‡ºäº†ä¸€å¼  ${card.suit}${card.rank}`);
            
            setTimeout(() => {
                const matchIndex = findMatch(card, tableCards);
                
                if (matchIndex !== -1) {
                    const collected = tableCards.splice(matchIndex);
                    collected.push(card);
                    computerScore += collected.length;
                    
                    updateMessage(`ç”µè„‘é’“èµ°äº† ${collected.length} å¼ ç‰Œï¼`);
                    updateScores();
                } else {
                    tableCards.push(card);
                    updateMessage('ç”µè„‘æ²¡æœ‰åŒ¹é…');
                }
                
                renderTable();
                
                // æ£€æŸ¥æ¸¸æˆç»“æŸ
                if (playerHand.length === 0 && computerHand.length === 0) {
                    setTimeout(endGame, 1000);
                    return;
                }
                
                if (computerHand.length === 0 && playerHand.length > 0) {
                    updateMessage('ç”µè„‘æ²¡ç‰Œäº†ï¼Œä½ ç»§ç»­');
                    isPlayerTurn = true;
                    return;
                }
                
                if (playerHand.length > 0) {
                    isPlayerTurn = true;
                    updateMessage('è½®åˆ°ä½ äº†');
                } else {
                    updateMessage('ä½ æ²¡æœ‰ç‰Œäº†...');
                    setTimeout(computerTurn, 1000);
                }
            }, 800);
        }
        
        function updateScores() {
            document.getElementById('player-score').textContent = playerScore;
            document.getElementById('computer-score').textContent = computerScore;
            document.getElementById('remaining').textContent = 
                playerHand.length + computerHand.length + tableCards.length;
        }
        
        function updateMessage(msg) {
            document.getElementById('message').textContent = msg;
        }
        
        function startGame() {
            // åˆå§‹åŒ–
            const deck = shuffle(createDeck());
            playerHand = deck.slice(0, 26);
            computerHand = deck.slice(26, 52);
            tableCards = [];
            playerScore = 0;
            computerScore = 0;
            selectedCard = -1;
            gameActive = true;
            isPlayerTurn = true;
            
            renderTable();
            renderPlayerHand();
            updateScores();
            updateMessage('æ¸¸æˆå¼€å§‹ï¼é€‰æ‹©ä¸€å¼ ç‰Œå‡ºç‰Œ');
            
            document.getElementById('start-btn').style.display = 'none';
            document.getElementById('play-btn').style.display = 'none';
        }
        
        function endGame() {
            gameActive = false;
            
            // å‰©ä½™çš„æ¡Œé¢ç‰Œå½’æœ€åå‡ºç‰Œçš„äººï¼ˆç®€åŒ–è§„åˆ™ï¼šå¹³åˆ†ï¼‰
            const remainingTable = tableCards.length;
            if (remainingTable > 0) {
                const half = Math.floor(remainingTable / 2);
                playerScore += half;
                computerScore += remainingTable - half;
                updateScores();
            }
            
            let result;
            if (playerScore > computerScore) {
                result = `ğŸ‰ æ­å–œä½ è·èƒœï¼ ${playerScore} vs ${computerScore}`;
            } else if (playerScore < computerScore) {
                result = `ç”µè„‘è·èƒœï¼ ${playerScore} vs ${computerScore}ï¼Œå†æ¥å†å‰ï¼`;
            } else {
                result = `å¹³å±€ï¼ ${playerScore} vs ${computerScore}`;
            }
            
            updateMessage(result);
            
            document.getElementById('start-btn').textContent = 'å†æ¥ä¸€å±€';
            document.getElementById('start-btn').style.display = 'inline-block';
            document.getElementById('play-btn').style.display = 'none';
        }
        
        function showRules() {
            const rules = document.getElementById('rules');
            rules.style.display = rules.style.display === 'none' ? 'block' : 'none';
        }
    </script>
</body>
</html>
