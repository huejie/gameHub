<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>躲避流星 - GameHub100</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Arial', sans-serif;
            background: #0a0a1a;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            color: white;
            padding: 20px;
        }
        .header { text-align: center; margin-bottom: 15px; }
        h1 { font-size: 2rem; }
        .game-container { position: relative; }
        canvas { border: 2px solid #f39c12; border-radius: 10px; display: block; cursor: none; }
        .stats { display: flex; justify-content: center; gap: 30px; margin: 15px 0; }
        .stat { text-align: center; }
        .stat-value { font-size: 1.5rem; font-weight: bold; color: #f39c12; }
        .controls { display: flex; justify-content: center; gap: 10px; margin-top: 15px; }
        button {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            background: #f39c12;
            color: #2d3436;
            font-weight: bold;
        }
        button:hover { background: #f1c40f; }
        .back-link { position: fixed; top: 15px; left: 15px; color: #f39c12; text-decoration: none; }
        .info { font-size: 0.85rem; opacity: 0.7; }
    </style>
</head>
<body>
    <a href="../../index.html" class="back-link">← 返回</a>
    <div class="header">
        <h1>☄️ 躲避流星</h1>
        <p class="info">移动鼠标控制飞船，躲避流星</p>
    </div>
    <div class="stats">
        <div class="stat"><div class="stat-value" id="score">0</div><div>得分</div></div>
        <div class="stat"><div class="stat-value" id="survived">0s</div><div>存活</div></div>
        <div class="stat"><div class="stat-value" id="high">0</div><div>最高</div></div>
    </div>
    <div class="game-container">
        <canvas id="gameCanvas" width="500" height="400"></canvas>
    </div>
    <div class="controls">
        <button onclick="startGame()">开始游戏</button>
    </div>
    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        let ship, meteors, stars, particles;
        let score = 0, highScore = 0;
        let gameRunning = false;
        let startTime = 0;
        
        // Generate stars
        stars = [];
        for (let i = 0; i < 100; i++) {
            stars.push({
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height,
                size: Math.random() * 2,
                speed: 0.5 + Math.random()
            });
        }
        
        function init() {
            ship = {x: canvas.width/2, y: canvas.height - 80, size: 15};
            meteors = [];
            particles = [];
            score = 0;
            startTime = Date.now();
        }
        
        function spawnMeteor() {
            if (Math.random() < 0.03 + score/5000) {
                meteors.push({
                    x: Math.random() * canvas.width,
                    y: -20,
                    size: 10 + Math.random() * 25,
                    speed: 3 + Math.random() * 3 + score/2000,
                    rotation: 0,
                    rotSpeed: (Math.random() - 0.5) * 0.2
                });
            }
        }
        
        function createExplosion(x, y) {
            for (let i = 0; i < 20; i++) {
                particles.push({
                    x, y,
                    dx: (Math.random() - 0.5) * 10,
                    dy: (Math.random() - 0.5) * 10,
                    life: 1,
                    color: Math.random() > 0.5 ? '#f39c12' : '#e74c3c'
                });
            }
        }
        
        function update() {
            if (!gameRunning) return;
            
            // Background
            ctx.fillStyle = '#0a0a1a';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Stars
            ctx.fillStyle = '#fff';
            stars.forEach(star => {
                star.y += star.speed;
                if (star.y > canvas.height) {
                    star.y = 0;
                    star.x = Math.random() * canvas.width;
                }
                ctx.beginPath();
                ctx.arc(star.x, star.y, star.size, 0, Math.PI * 2);
                ctx.fill();
            });
            
            // Update meteors
            spawnMeteor();
            meteors.forEach(m => {
                m.y += m.speed;
                m.rotation += m.rotSpeed;
            });
            meteors = meteors.filter(m => m.y < canvas.height + 50);
            
            // Draw meteors
            meteors.forEach(m => {
                ctx.save();
                ctx.translate(m.x, m.y);
                ctx.rotate(m.rotation);
                ctx.fillStyle = '#8b4513';
                ctx.beginPath();
                for (let i = 0; i < 8; i++) {
                    const angle = (i/8) * Math.PI * 2;
                    const r = m.size * (0.7 + Math.random() * 0.3);
                    const px = Math.cos(angle) * r;
                    const py = Math.sin(angle) * r;
                    if (i === 0) ctx.moveTo(px, py);
                    else ctx.lineTo(px, py);
                }
                ctx.closePath();
                ctx.fill();
                
                // Flame
                ctx.fillStyle = 'rgba(255, 100, 0, 0.5)';
                ctx.beginPath();
                ctx.ellipse(0, -m.size*0.3, m.size*0.3, m.size*0.5, 0, 0, Math.PI*2);
                ctx.fill();
                ctx.restore();
            });
            
            // Draw ship
            ctx.fillStyle = '#3498db';
            ctx.beginPath();
            ctx.moveTo(ship.x, ship.y - ship.size);
            ctx.lineTo(ship.x - ship.size, ship.y + ship.size);
            ctx.lineTo(ship.x + ship.size, ship.y + ship.size);
            ctx.closePath();
            ctx.fill();
            
            // Engine glow
            ctx.fillStyle = '#f39c12';
            ctx.beginPath();
            ctx.arc(ship.x, ship.y + ship.size, 5 + Math.random()*3, 0, Math.PI*2);
            ctx.fill();
            
            // Check collision
            for (let m of meteors) {
                const dx = ship.x - m.x;
                const dy = ship.y - m.y;
                if (Math.sqrt(dx*dx + dy*dy) < ship.size + m.size * 0.7) {
                    createExplosion(ship.x, ship.y);
                    gameRunning = false;
                    if (score > highScore) highScore = score;
                    document.getElementById('high').textContent = highScore;
                    setTimeout(() => alert(`游戏结束！得分: ${score}`), 100);
                    return;
                }
            }
            
            // Update particles
            particles = particles.filter(p => p.life > 0);
            particles.forEach(p => {
                p.x += p.dx;
                p.y += p.dy;
                p.life -= 0.03;
                ctx.globalAlpha = p.life;
                ctx.fillStyle = p.color;
                ctx.fillRect(p.x, p.y, 4, 4);
                ctx.globalAlpha = 1;
            });
            
            score++;
            const survived = Math.floor((Date.now() - startTime) / 1000);
            document.getElementById('score').textContent = score;
            document.getElementById('survived').textContent = survived + 's';
            
            requestAnimationFrame(update);
        }
        
        canvas.addEventListener('mousemove', e => {
            const rect = canvas.getBoundingClientRect();
            ship.x = (e.clientX - rect.left) * (canvas.width / rect.width);
            ship.y = (e.clientY - rect.top) * (canvas.height / rect.height);
            ship.x = Math.max(ship.size, Math.min(canvas.width - ship.size, ship.x));
            ship.y = Math.max(ship.size, Math.min(canvas.height - ship.size, ship.y));
        });
        
        function startGame() {
            init();
            gameRunning = true;
            update();
        }
        
        // Initial draw
        ctx.fillStyle = '#0a0a1a';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        ctx.fillStyle = '#fff';
        ctx.font = '20px Arial';
        ctx.textAlign = 'center';
        ctx.fillText('移动鼠标开始', canvas.width/2, canvas.height/2);
    </script>
</body>
</html>