<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æŠ“å¨ƒå¨ƒ - GameHub100</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            color: white;
            padding: 20px;
        }
        .header { text-align: center; margin-bottom: 15px; }
        h1 { font-size: 2rem; margin-bottom: 5px; }
        canvas { border: 3px solid #fff; border-radius: 10px; display: block; background: #2c3e50; }
        .stats { display: flex; justify-content: center; gap: 30px; margin: 15px 0; }
        .stat { text-align: center; }
        .stat-value { font-size: 1.5rem; font-weight: bold; color: #f1c40f; }
        .controls { display: flex; justify-content: center; gap: 10px; margin-top: 15px; }
        button {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            background: #e74c3c;
            color: white;
            font-weight: bold;
            font-size: 1rem;
        }
        button:hover { background: #c0392b; }
        button:disabled { background: #7f8c8d; cursor: not-allowed; }
        .back-link { position: fixed; top: 15px; left: 15px; color: #f1c40f; text-decoration: none; }
        .instructions { margin-top: 10px; text-align: center; font-size: 0.9rem; opacity: 0.8; }
    </style>
</head>
<body>
    <a href="../../index.html" class="back-link">â† è¿”å›</a>
    <div class="header">
        <h1>ğŸ§¸ æŠ“å¨ƒå¨ƒ</h1>
        <p>æ§åˆ¶æŠ“æ‰‹ï¼ŒæŠ“å–å¯çˆ±çš„å¨ƒå¨ƒï¼</p>
    </div>
    <div class="stats">
        <div class="stat"><div class="stat-value" id="score">0</div><div>å¾—åˆ†</div></div>
        <div class="stat"><div class="stat-value" id="caught">0</div><div>æŠ“åˆ°</div></div>
        <div class="stat"><div class="stat-value" id="time">60</div><div>æ—¶é—´</div></div>
    </div>
    <canvas id="gameCanvas" width="400" height="500"></canvas>
    <div class="controls">
        <button id="startBtn" onclick="startGame()">å¼€å§‹æ¸¸æˆ</button>
        <button id="grabBtn" onclick="grab()" disabled>æŠ“å– (ç©ºæ ¼)</button>
    </div>
    <div class="instructions">
        ä½¿ç”¨ â† â†’ æ–¹å‘é”®ç§»åŠ¨æŠ“æ‰‹ | ç©ºæ ¼é”®æŠ“å–
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const startBtn = document.getElementById('startBtn');
        const grabBtn = document.getElementById('grabBtn');

        let claw, dolls, hook;
        let score = 0, caught = 0, timeLeft = 60;
        let gameRunning = false;
        let gameTimer;
        let keys = {};

        const dollEmojis = ['ğŸ§¸', 'ğŸ°', 'ğŸ»', 'ğŸ¼', 'ğŸ¨', 'ğŸ¦Š', 'ğŸ¯', 'ğŸ¦'];

        function init() {
            claw = { x: canvas.width / 2, y: 30, width: 60, speed: 5 };
            hook = { x: claw.x, y: claw.y + 30, length: 30, maxLength: 350, extending: false, retracting: false, grabbed: null };
            dolls = [];
            score = 0;
            caught = 0;
            timeLeft = 60;

            // ç”Ÿæˆå¨ƒå¨ƒ
            for (let i = 0; i < 8; i++) {
                dolls.push({
                    x: 50 + Math.random() * (canvas.width - 100),
                    y: 380 + Math.random() * 80,
                    emoji: dollEmojis[Math.floor(Math.random() * dollEmojis.length)],
                    size: 35,
                    caught: false
                });
            }

            updateDisplay();
        }

        function updateDisplay() {
            document.getElementById('score').textContent = score;
            document.getElementById('caught').textContent = caught;
            document.getElementById('time').textContent = timeLeft;
        }

        function startGame() {
            if (gameRunning) return;
            init();
            gameRunning = true;
            startBtn.disabled = true;
            grabBtn.disabled = false;
            
            gameTimer = setInterval(() => {
                timeLeft--;
                updateDisplay();
                if (timeLeft <= 0) {
                    endGame();
                }
            }, 1000);
            
            gameLoop();
        }

        function endGame() {
            gameRunning = false;
            clearInterval(gameTimer);
            startBtn.disabled = false;
            grabBtn.disabled = true;
            
            setTimeout(() => {
                alert(`æ¸¸æˆç»“æŸï¼\næŠ“åˆ°: ${caught} ä¸ªå¨ƒå¨ƒ\nå¾—åˆ†: ${score}`);
            }, 100);
        }

        function grab() {
            if (!gameRunning || hook.extending || hook.retracting) return;
            hook.extending = true;
            grabBtn.disabled = true;
        }

        function gameLoop() {
            if (!gameRunning) return;

            // æ¸…ç©ºç”»å¸ƒ
            ctx.fillStyle = '#2c3e50';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // ç»˜åˆ¶é¡¶éƒ¨è½¨é“
            ctx.fillStyle = '#34495e';
            ctx.fillRect(0, 0, canvas.width, 60);

            // ç»˜åˆ¶å¨ƒå¨ƒåŒºåŸŸ
            ctx.fillStyle = '#1a252f';
            ctx.fillRect(0, 350, canvas.width, canvas.height - 350);

            // ç§»åŠ¨æŠ“æ‰‹
            if (keys['ArrowLeft'] || keys['KeyA']) {
                claw.x = Math.max(30, claw.x - claw.speed);
            }
            if (keys['ArrowRight'] || keys['KeyD']) {
                claw.x = Math.min(canvas.width - 30, claw.x + claw.speed);
            }

            if (!hook.extending && !hook.retracting) {
                hook.x = claw.x;
            }

            // æ›´æ–°é’©å­
            if (hook.extending) {
                hook.length += 5;
                if (hook.length >= hook.maxLength) {
                    hook.extending = false;
                    hook.retracting = true;
                }
                
                // æ£€æµ‹ç¢°æ’
                if (!hook.grabbed) {
                    for (let doll of dolls) {
                        if (!doll.caught) {
                            const hookEndX = hook.x;
                            const hookEndY = claw.y + hook.length;
                            const dx = hookEndX - doll.x;
                            const dy = hookEndY - doll.y;
                            if (Math.sqrt(dx * dx + dy * dy) < doll.size) {
                                hook.grabbed = doll;
                                doll.caught = true;
                                hook.extending = false;
                                hook.retracting = true;
                                break;
                            }
                        }
                    }
                }
            }

            if (hook.retracting) {
                hook.length -= 3;
                if (hook.length <= 30) {
                    hook.length = 30;
                    hook.retracting = false;
                    grabBtn.disabled = false;
                    
                    if (hook.grabbed) {
                        caught++;
                        score += 10;
                        hook.grabbed = null;
                        updateDisplay();
                        
                        // æ£€æŸ¥æ˜¯å¦æ‰€æœ‰å¨ƒå¨ƒéƒ½è¢«æŠ“å®Œ
                        if (dolls.every(d => d.caught)) {
                            // ç”Ÿæˆæ–°çš„å¨ƒå¨ƒ
                            dolls = [];
                            for (let i = 0; i < 8; i++) {
                                dolls.push({
                                    x: 50 + Math.random() * (canvas.width - 100),
                                    y: 380 + Math.random() * 80,
                                    emoji: dollEmojis[Math.floor(Math.random() * dollEmojis.length)],
                                    size: 35,
                                    caught: false
                                });
                            }
                        }
                    }
                }
            }

            // ç»˜åˆ¶ç»³ç´¢
            ctx.strokeStyle = '#f1c40f';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(hook.x, claw.y);
            ctx.lineTo(hook.x, claw.y + hook.length);
            ctx.stroke();

            // ç»˜åˆ¶é’©å­
            ctx.fillStyle = '#e74c3c';
            ctx.beginPath();
            ctx.arc(hook.x, claw.y + hook.length, 10, 0, Math.PI * 2);
            ctx.fill();
            
            // ç»˜åˆ¶é’©å­çˆª
            ctx.strokeStyle = '#e74c3c';
            ctx.lineWidth = 4;
            ctx.beginPath();
            ctx.moveTo(hook.x - 15, claw.y + hook.length + 10);
            ctx.lineTo(hook.x, claw.y + hook.length);
            ctx.lineTo(hook.x + 15, claw.y + hook.length + 10);
            ctx.stroke();

            // ç»˜åˆ¶æŠ“æ‰‹
            ctx.fillStyle = '#e74c3c';
            ctx.fillRect(claw.x - 30, claw.y - 15, 60, 30);
            ctx.fillStyle = '#c0392b';
            ctx.fillRect(claw.x - 25, claw.y - 10, 50, 20);

            // ç»˜åˆ¶è¢«æŠ“çš„å¨ƒå¨ƒ
            if (hook.grabbed) {
                hook.grabbed.x = hook.x;
                hook.grabbed.y = claw.y + hook.length + 25;
            }

            // ç»˜åˆ¶å¨ƒå¨ƒ
            ctx.font = '35px Arial';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            for (let doll of dolls) {
                if (!doll.caught || doll === hook.grabbed) {
                    ctx.fillText(doll.emoji, doll.x, doll.y);
                }
            }

            requestAnimationFrame(gameLoop);
        }

        // é”®ç›˜æ§åˆ¶
        document.addEventListener('keydown', (e) => {
            keys[e.code] = true;
            if (e.code === 'Space') {
                e.preventDefault();
                grab();
            }
        });

        document.addEventListener('keyup', (e) => {
            keys[e.code] = false;
        });

        // åˆå§‹åŒ–æ˜¾ç¤º
        init();
        
        // ç»˜åˆ¶åˆå§‹çŠ¶æ€
        ctx.fillStyle = '#2c3e50';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        ctx.fillStyle = '#34495e';
        ctx.fillRect(0, 0, canvas.width, 60);
        ctx.fillStyle = '#1a252f';
        ctx.fillRect(0, 350, canvas.width, canvas.height - 350);
        ctx.font = '35px Arial';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        for (let doll of dolls) {
            ctx.fillText(doll.emoji, doll.x, doll.y);
        }
    </script>
</body>
</html>
